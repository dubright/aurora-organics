<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Aurora Organics üåø</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Inter", sans-serif;
      background: radial-gradient(circle at 20% 20%, #0f1115, #070809 80%);
      color: #e6e6e6;
      display: flex;
      height: 100vh;
      overflow: hidden;
    }

    /* === MENU ESQUERDO === */
    aside {
      width: 240px;
      background: linear-gradient(180deg, #101213, #0b0d0e);
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
      border-right: 1px solid #1b1e22;
    }

    aside h1 {
      font-size: 1.3rem;
      color: #00e676;
      display: flex;
      align-items: center;
      gap: 8px;
      text-shadow: 0 0 10px rgba(0, 230, 118, 0.4);
    }

    .nav-btn {
      background: none;
      border: none;
      color: #b5b5b5;
      font-size: 1rem;
      text-align: left;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 6px;
      transition: 0.3s;
    }

    .nav-btn.active, .nav-btn:hover {
      background: #13281d;
      color: #00e676;
      font-weight: 600;
      text-shadow: 0 0 10px rgba(0, 230, 118, 0.3);
    }

    /* === √ÅREA PRINCIPAL === */
    main {
      flex: 1;
      display: flex;
      overflow: hidden;
    }

    .content {
      flex: 1;
      padding: 2rem;
      overflow-y: auto;
    }

    /* === PAINEL DIREITO === */
    .sidebar-right {
      width: 300px;
      background: linear-gradient(180deg, #121417, #0f1115);
      border-left: 1px solid #1d1f23;
      padding: 1rem;
      overflow-y: auto;
      box-shadow: inset 0 0 10px rgba(0,0,0,0.3);
    }

    h2 {
      color: #00e676;
      margin-top: 0;
      font-weight: 600;
      letter-spacing: 0.5px;
    }

    .card {
      background: linear-gradient(145deg, #171a1f, #121417);
      padding: 1rem 1.5rem;
      border-radius: 14px;
      margin-bottom: 1rem;
      border: 1px solid #1e2228;
      box-shadow: 0 4px 15px rgba(0, 230, 118, 0.04);
      transition: transform 0.2s ease;
    }

    .card:hover {
      transform: scale(1.015);
    }

    .dashboard-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1.2rem;
      margin-bottom: 2rem;
    }

    .progress {
      height: 8px;
      background: #1e2228;
      border-radius: 4px;
      overflow: hidden;
      margin-top: 8px;
    }

    .progress-bar {
      height: 100%;
      transition: width 0.6s ease;
      border-radius: 4px;
    }

    .progress-bar.green { background: linear-gradient(90deg, #00e676, #00ff99); }
    .progress-bar.blue { background: linear-gradient(90deg, #00bcd4, #4dd0e1); }
    .progress-bar.orange { background: linear-gradient(90deg, #f9a825, #ffb74d); }

    .project-card {
      background: linear-gradient(145deg, #1b1e24, #16191d);
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 1rem;
      border: 1px solid #23272f;
      transition: 0.3s;
    }

    .project-card:hover {
      border-color: #00e676;
      box-shadow: 0 0 10px rgba(0,230,118,0.2);
    }

    .project-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .btn-icon {
      background: #00e676;
      border: none;
      border-radius: 8px;
      color: #000;
      font-weight: 600;
      padding: 6px 10px;
      cursor: pointer;
      transition: 0.3s;
    }

    .btn-icon:hover { transform: scale(1.07); }

    .form-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 1rem;
    }

    select, input, button {
      border: none;
      border-radius: 8px;
      padding: 8px 10px;
      font-family: inherit;
    }

    button.action {
      background: #00e676;
      color: #000;
      font-weight: 600;
      cursor: pointer;
      transition: 0.3s;
    }

    button.action:hover { transform: scale(1.05); }

    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #00e676;
      color: #000;
      padding: 10px 20px;
      border-radius: 10px;
      font-weight: 600;
      animation: slideIn 0.5s ease;
    }

    @keyframes slideIn {
      from { transform: translateY(50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
  </style>
</head>
<body>
  <aside>
    <h1>üåø Aurora</h1>
    <button class="nav-btn active" data-page="dashboard">Dashboard</button>
    <button class="nav-btn" data-page="projects">Projetos</button>
  </aside>

  <main>
    <div class="content" id="root"></div>
    <div class="sidebar-right" id="sidePanel"></div>
  </main>
<script type="text/babel">
const { useState, useEffect } = React;

const plantas = ["Ab√≥bora","Abobrinha","Alface","Cenoura","Couve","Tomate","Morango","Uva","Laranja","Lim√£o"];
const fertilizantes = ["BioBizz","Forth","Dimy"];

const duracaoCultivo = {
  "Alface": 60, "Cenoura": 90, "Tomate": 120, "Couve": 100, "Morango": 80,
  "Ab√≥bora": 100, "Abobrinha": 90, "Uva": 150, "Laranja": 200, "Lim√£o": 200
};

const litragemIdeal = {
  "700ml": 0.5,
  "5L": 1.5,
  "10L": 2.5,
  "15L": 3.5
};

const getFase = dias => {
  if (dias < 10) return { nome: "Germina√ß√£o", icone: "üå±", cor: "#00ff99" };
  if (dias < 40) return { nome: "Crescimento", icone: "üåø", cor: "#00e676" };
  if (dias < 70) return { nome: "Flora√ß√£o", icone: "üå∏", cor: "#c084fc" };
  return { nome: "Pr√©-colheita", icone: "üçÖ", cor: "#fca311" };
};

const formatDate = d => new Date(d).toLocaleDateString("pt-BR",{ day:"2-digit", month:"short" });

function App() {
  const [projects, setProjects] = useState(JSON.parse(localStorage.getItem("projects") || "[]"));
  const [page, setPage] = useState("dashboard");
  const [selectedProject, setSelectedProject] = useState(null);
  const [toast, setToast] = useState("");
  const [nome, setNome] = useState("");

  useEffect(() => localStorage.setItem("projects", JSON.stringify(projects)), [projects]);

  const showToast = msg => { setToast(msg); setTimeout(() => setToast(""), 2500); };

  const addProject = () => {
    if (!nome.trim()) return alert("Informe um nome para o projeto.");
    const novo = { id: Date.now(), nome, dataCriacao: new Date().toLocaleDateString(), cultivos: [], historico: [] };
    setProjects([...projects, novo]);
    setNome("");
    showToast("üåø Projeto criado!");
  };

  const addCultivo = (projId, form) => {
    const diasTotais = duracaoCultivo[form.planta] || 60;
    const projeto = projects.find(p => p.id === projId);

    const tarefasGeradas = [];
    const dataInicial = new Date(form.data);
    for (let i = 0; i < diasTotais; i += 5) {
      const dataTarefa = new Date(dataInicial.getTime() + i * 86400000);
      tarefasGeradas.push({
        data: dataTarefa.toISOString(),
        tipo: i % 10 === 0 ? "fertilizante" : "√°gua",
        status: "pendente",
        qtdLitros: litragemIdeal[form.litragem] || 1
      });
    }

    const novoCultivo = { ...form, id: Date.now(), tarefas: tarefasGeradas };
    const atualizado = projects.map(p =>
      p.id === projId
        ? { ...p, cultivos: [...p.cultivos, novoCultivo], historico: [...p.historico, { data: new Date().toLocaleDateString(), acao: `üå± Novo cultivo de ${form.planta}` }] }
        : p
    );
    setProjects(atualizado);
    showToast("üå± Cultivo adicionado com tarefas autom√°ticas!");
  };
  function Dashboard() {
    const [selectedId, setSelectedId] = useState(selectedProject ? selectedProject.id : "");
    const projeto = projects.find(p => p.id === Number(selectedId));

    const allCultivos = projeto ? projeto.cultivos : [];
    const totalQ = allCultivos.reduce((a,b) => a + Number(b.quantidade||0), 0);
    const totalTarefas = allCultivos.flatMap(c => c.tarefas || []).length;
    const pendentes = allCultivos.flatMap(c => c.tarefas || []).filter(t => t.status === "pendente");
    const concluidas = totalTarefas - pendentes.length;
    const eficiencia = totalTarefas ? ((concluidas / totalTarefas) * 100).toFixed(1) : 0;
    const produtividade = totalQ * 1.8;
    const lucro = produtividade * 9.5;
    const custo = totalQ * 5;

    const hoje = new Date();
    const proximasTarefas = projeto
      ? projeto.cultivos.flatMap(c => c.tarefas || [])
          .filter(t => {
            const d = new Date(t.data);
            const diff = (d - hoje) / 86400000;
            return diff >= 0 && diff <= 5;
          })
      : [];

    return (
      <>
        <h2>üìä Dashboard Imersivo</h2>

        <div className="form-group">
          <select value={selectedId} onChange={e=>{
            const proj = projects.find(p=>p.id===Number(e.target.value));
            setSelectedProject(proj);
            setSelectedId(e.target.value);
          }}>
            <option value="">Selecione um projeto</option>
            {projects.map(p=><option key={p.id} value={p.id}>{p.nome}</option>)}
          </select>
        </div>

        {projeto ? (
          <>
            <div className="dashboard-cards">
              <div className="card"><h3>üåø Cultivos</h3><p>{allCultivos.length}</p></div>
              <div className="card"><h3>üì¶ Quantidade</h3><p>{totalQ}</p></div>
              <div className="card"><h3>üíß Efici√™ncia</h3><p>{eficiencia}%</p></div>
              <div className="card"><h3>üí∞ Lucro</h3><p>R$ {lucro.toFixed(2)}</p></div>
            </div>

            <div className="card">
              <h3>üìÖ Pr√≥ximas Tarefas (5 dias)</h3>
              {proximasTarefas.length>0
                ? proximasTarefas.map((t,i)=>
                    <div key={i} style={{color:t.tipo==="fertilizante"?"#fca311":"#00e676"}}>
                      {new Date(t.data).toLocaleDateString("pt-BR")} ‚Äî üíß {t.tipo} ‚Äî {t.qtdLitros}L
                    </div>
                  )
                : <div style={{opacity:0.7}}>Nenhuma tarefa nos pr√≥ximos dias</div>}
            </div>
          </>
        ) : (
          <div style={{opacity:0.6}}>Selecione um projeto para visualizar o painel</div>
        )}
      </>
    );
  }

  return (
    <div style={{padding:"2rem"}}>
      <nav style={{marginBottom:"2rem"}}>
        <button className={`nav-btn ${page==="dashboard"?"active":""}`} onClick={()=>setPage("dashboard")}>Dashboard</button>
        <button className={`nav-btn ${page==="projects"?"active":""}`} onClick={()=>setPage("projects")}>Projetos</button>
      </nav>

      {page==="dashboard" ? <Dashboard/> : (
        <>
          <h2>üåø Projetos</h2>
          <div className="form-group">
            <input placeholder="Nome do Projeto" value={nome} onChange={e=>setNome(e.target.value)}/>
            <button className="action" onClick={addProject}>+ Novo Projeto</button>
          </div>
          {projects.map(p=>(
            <div key={p.id} className="card">
              <strong>{p.nome}</strong>
              <div className="small">{p.cultivos.length} cultivos ‚Ä¢ criado em {p.dataCriacao}</div>
            </div>
          ))}
        </>
      )}
      {toast && <div className="toast">{toast}</div>}
    </div>
  );
}

const root = ReactDOM.createRoot(document.getElementById("root"));
root.render(<App />);
</script>
