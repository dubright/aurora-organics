<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aurora Organics ðŸŒ¿</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
      :root {
        --bg: #121212;
        --card: #1e1e1e;
        --text: #e2e2e2;
        --accent: #7ef29d;
      }
      [data-theme="clear"] {
        --bg: #f9f9f9;
        --card: #ffffff;
        --text: #333;
        --accent: #3b9c5d;
      }
      [data-theme="pro"] {
        --bg: #101418;
        --card: #1c1f26;
        --text: #e8e8e8;
        --accent: #c8b55e;
      }
      body {
        background: var(--bg);
        color: var(--text);
        font-family: "Inter", sans-serif;
        margin: 0;
        padding: 0;
      }
      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem 2rem;
        background: var(--card);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }
      h1 {
        font-size: 1.3rem;
      }
      button {
        cursor: pointer;
        background: var(--accent);
        color: #000;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-weight: 600;
        transition: all 0.3s;
      }
      button:hover {
        opacity: 0.8;
      }
      .container {
        padding: 1.5rem 2rem;
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
      }
      .card {
        background: var(--card);
        padding: 1rem 1.5rem;
        border-radius: 12px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
      }
      .input-group {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
        align-items: center;
      }
      input, select {
        background: var(--bg);
        border: 1px solid var(--accent);
        color: var(--text);
        padding: 0.4rem 0.6rem;
        border-radius: 6px;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 1rem;
      }
      th, td {
        padding: 0.5rem;
        border-bottom: 1px solid var(--accent);
      }
      .phase {
        margin: 0.8rem 0;
        padding: 0.8rem;
        border-radius: 10px;
        background: var(--card);
      }
      .theme-menu {
        position: absolute;
        top: 60px;
        right: 20px;
        background: var(--card);
        padding: 0.8rem;
        border-radius: 10px;
        display: none;
      }
      .theme-menu.active {
        display: block;
      }
    </style>
  </head>

  <body>
    <header>
      <h1>ðŸŒ± Aurora Organics</h1>
      <div style="position: relative;">
        <button id="themeButton">Alterar Tema</button>
        <div id="themeMenu" class="theme-menu">
          <p><button data-theme="dark">Aurora Dark</button></p>
          <p><button data-theme="clear">Aurora Clear</button></p>
          <p><button data-theme="pro">Aurora Pro</button></p>
        </div>
      </div>
    </header>

    <div id="root"></div>

    <script type="text/babel">

      const fertilizantes = {
        Biobizz: { germ: 1, cresc: 2, flor: 3, pre: 2 },
        Forth: { germ: 2, cresc: 2.5, flor: 3, pre: 1 },
        Dimy: { germ: 1, cresc: 2, flor: 2, pre: 1.5 },
        Lindeza: { germ: 1.5, cresc: 2.5, flor: 3, pre: 2 },
        Cibra: { germ: 2, cresc: 3, flor: 3.5, pre: 2 }
      };

      const cultivosLista = ["AbÃ³bora","Abobrinha","Acelga","AgriÃ£o","Aipo (salsÃ£o)","Alcachofra","Alface","Alho","Alho-porÃ³",
        "AlmeirÃ£o","Aspargo","Batata","Batata-doce","Berinjela","Beterraba","BrÃ³colis","Cenoura","Couve","Couve-flor",
        "Ervilha","Espinafre","FeijÃ£o-vagem","Gengibre","JilÃ³","Maxixe","Milho verde","Moranga","Nabo","Pepino","Pimenta",
        "PimentÃ£o","Quiabo","Rabanete","Repolho","RÃºcula","Salsa","Taioba","Tomate","Abacate","Abacaxi","Acerola","Amora",
        "Banana","Caju","Caju","Goiaba","Jabuticaba","Laranja","LimÃ£o","MamÃ£o","Manga","MaracujÃ¡","Melancia","MelÃ£o","Morango",
        "PÃªssego","Pitanga","Uva"
      ];

      function App() {
        const [cultivos, setCultivos] = React.useState(JSON.parse(localStorage.getItem("cultivos")) || []);
        const [nome, setNome] = React.useState("");
        const [data, setData] = React.useState("");
        const [fert, setFert] = React.useState("Biobizz");
        const [editingIndex, setEditingIndex] = React.useState(null);
        const [tema, setTema] = React.useState(localStorage.getItem("tema") || "dark");
        const [aplicados, setAplicados] = React.useState({});

        React.useEffect(() => {
          document.documentElement.setAttribute("data-theme", tema);
          localStorage.setItem("tema", tema);
        }, [tema]);

        React.useEffect(() => {
          localStorage.setItem("cultivos", JSON.stringify(cultivos));
        }, [cultivos]);

        const addCultivo = () => {
          if (!nome || !data) return alert("Preencha o nome e data de germinaÃ§Ã£o!");
          const novo = { nome, data, fert };
          if (editingIndex !== null) {
            const atualizados = [...cultivos];
            atualizados[editingIndex] = novo;
            setCultivos(atualizados);
            setEditingIndex(null);
          } else setCultivos([...cultivos, novo]);
          setNome(""); setData("");
        };

        const deleteCultivo = (i) => {
          if (confirm("Excluir cultivo?")) {
            const atualizados = cultivos.filter((_, idx) => idx !== i);
            setCultivos(atualizados);
          }
        };

        const editCultivo = (i) => {
          const c = cultivos[i];
          setNome(c.nome);
          setData(c.data);
          setFert(c.fert);
          setEditingIndex(i);
        };

        const toggleApliquei = (fase) => {
          setAplicados({ ...aplicados, [fase]: !aplicados[fase] });
        };

        const calcularFases = (d) => {
          const base = new Date(d);
          const add = (days) => {
            const nd = new Date(base);
            nd.setDate(nd.getDate() + days);
            return nd.toLocaleDateString("pt-BR", { day: "2-digit", month: "2-digit" });
          };
          return [
            { nome: "GerminaÃ§Ã£o", ini: add(0), fim: add(7) },
            { nome: "Crescimento", ini: add(7), fim: add(20) },
            { nome: "FloraÃ§Ã£o", ini: add(20), fim: add(30) },
            { nome: "PrÃ©-colheita", ini: add(30), fim: add(45) }
          ];
        };

        const dosagem = (fase) => Math.round(fertilizantes[fert][fase] * 0.7 * 10) / 10;

        const cultivoAtual = cultivos[editingIndex ?? 0];

        return (
          <div className="container">
            <div className="card">
              <h2>ðŸ“‹ Cadastro de Cultivos</h2>
              <div className="input-group">
                <input list="cultivos" value={nome} onChange={e => setNome(e.target.value)} placeholder="Tipo de cultivo" />
                <datalist id="cultivos">{cultivosLista.map((c,i)=><option key={i} value={c} />)}</datalist>
                <input type="date" value={data} onChange={e=>setData(e.target.value)} />
                <select value={fert} onChange={e=>setFert(e.target.value)}>
                  {Object.keys(fertilizantes).map(f=><option key={f}>{f}</option>)}
                </select>
                <button onClick={addCultivo}>{editingIndex!==null ? "Salvar" : "Adicionar"}</button>
              </div>
              <table>
                <thead><tr><th>Planta</th><th>GerminaÃ§Ã£o</th><th>Fertilizante</th><th>AÃ§Ãµes</th></tr></thead>
                <tbody>
                  {cultivos.map((c,i)=>(
                    <tr key={i}>
                      <td onClick={()=>setEditingIndex(i)} style={{cursor:"pointer"}}>{c.nome}</td>
                      <td>{new Date(c.data).toLocaleDateString("pt-BR")}</td>
                      <td>{c.fert}</td>
                      <td>
                        <button onClick={()=>editCultivo(i)}>Editar</button>
                        <button onClick={()=>deleteCultivo(i)}>Excluir</button>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>

            {cultivoAtual && (
              <div className="card">
                <h2>ðŸ§ª RecomendaÃ§Ãµes de Fertilizantes</h2>
                <h3>{cultivoAtual.nome} â€” {cultivoAtual.fert}</h3>
                {calcularFases(cultivoAtual.data).map((f,i)=>(
                  <div key={i} className="phase">
                    <strong>{f.nome}</strong> â€” {f.ini} atÃ© {f.fim}<br/>
                    Dosagem: <b>{dosagem(["germ","cresc","flor","pre"][i])} ml</b> / 700ml de Ã¡gua<br/>
                    <button onClick={()=>toggleApliquei(f.nome)}>
                      {aplicados[f.nome] ? "âœ… Apliquei" : "Aplicar"}
                    </button>
                  </div>
                ))}
              </div>
            )}
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById("root")).render(<App />);

      const btn = document.getElementById("themeButton");
      const menu = document.getElementById("themeMenu");
      btn.onclick = () => menu.classList.toggle("active");
      menu.querySelectorAll("button").forEach(b=>{
        b.onclick = ()=> {
          document.documentElement.setAttribute("data-theme", b.dataset.theme);
          localStorage.setItem("tema", b.dataset.theme);
          menu.classList.remove("active");
        };
      });

    </script>
  </body>
</html>
